function updateMinifiguresCount(e){$.each(e,function(e,t){var i=$('[data-id="'+e+'"]'),n=i.parents(".item-col"),a=i.parents(".range-container"),o=i.parents(".serie-container");t>0?i.find(".item-count").text("x"+t):a.find(".item-col").length<=1?a.remove():o.find(".item-col").length<=1?o.remove():n.remove()})}$(document).ready(function(){displayChart();var e;$("a.delete-link").on("click",function(t){t.preventDefault(),e=$(this).attr("href"),$(".delete-dialog td.title").text($(this).parent().siblings(".title").find(".title-text").text()),$(".delete-dialog td.type").text($(this).parent().siblings(".title").find(".type-text").text()),$(".delete-dialog").fadeIn(100).css({"max-width":"460"});var i=$(".delete-dialog").width(),n=$(".delete-dialog").height(),a=$(window).height(),o=$(window).width(),l=a/2-n/2+$("body").scrollTop(),d=o/2-i/2;return $(".delete-dialog").css({"margin-top":l,"margin-left":d}),$("body").append('<div id="overlay" class="overlay"></div>'),$("#overlay").css({filter:"alpha(opacity=50)"}).fadeIn(100),$(window).resize(function(){var e=$(".delete-dialog").width(),t=$(".delete-dialog").height(),i=$(window).height(),n=$(window).width(),a=i/2-t/2+$("body").scrollTop(),o=n/2-e/2;$(".delete-dialog").css({"margin-top":a,"margin-left":o})}),$(window).scroll(function(){var e=$(".delete-dialog").height(),t=$(window).height(),i=t/2-e/2+$("body").scrollTop();$(".delete-dialog").css({"margin-top":i})}),!1}),$("body").on("click",".delete-dialog a.delete",function(t){t.preventDefault(),window.location.href=e}),$("body").on("click",".delete-dialog a.cancel, .delete-dialog a.close, #overlay",function(e){e.preventDefault(),$("#overlay , .delete-dialog").fadeOut(100,function(){$("#overlay").remove()})}),$(".item-type-button").on("click",function(){$(".item-type-button").removeClass("active"),$(this).addClass("active");var e=$(this).data("type");$(".item-list").removeClass("shown"),$("."+e+"-list").addClass("shown")}),$(".item .edit-button").click(function(){$(".item-number").removeClass("active"),$(this).parents(".item-container").find(".item-number").addClass("active")}),$(document).click(function(e){$(e.target).closest(".item-number.active, .item .edit-button").length||($(".item-number").removeClass("active"),$(".item-number-content").delay(animationDuration).removeClass("hidden"),$(".item-number .item-confirmation-content").delay(animationDuration).addClass("hidden"))}),$(".item-number .less-item-button").click(function(e){var t=$(this).parents(".input-container"),i=t.find(".item-number-input");parseInt(i.val(),10)>1&&i.val(parseInt(i.val(),10)-1)}),$(".item-number .more-item-button").click(function(e){var t=$(this).parents(".input-container"),i=t.find(".item-number-input");i.val(parseInt(i.val(),10)+1)}),$(".item-number .edit-button").click(function(e){e.preventDefault();var t=$(this).siblings(".input-container").find(".item-id-input").val(),i=$(this).siblings(".input-container").find(".item-type-input").val(),n=$(this).siblings(".input-container").find(".item-number-input").val(),a=$(this).parents(".item-container").find(".item-number-content"),o=$(this).parents(".item-container").find(".item-number .item-confirmation-content"),l=$(this).parents(".item-container").find(".item-count");$.ajax({url:"/collection/edit",data:"item_id="+t+"&item_count="+n+"&item_type="+i,dataType:"json",success:function(e){e===!1?window.location.href="/members/login":(a.addClass("hidden"),o.removeClass("hidden"),l.text("x"+n),updateMinifiguresCount(e))}})}),$(".item .delete-button").click(function(){$(".item-delete").removeClass("active"),$(this).parents(".item-container").find(".item-delete").addClass("active")}),$(document).click(function(e){(!$(e.target).closest(".item-delete.active, .item .delete-button").length||$(e.target).closest(".item-delete.active .cancel-button").length)&&($(".item-delete").removeClass("active"),$(".item-delete-content").delay(animationDuration).removeClass("hidden"),$(".item-delete .item-confirmation-content").delay(animationDuration).addClass("hidden"))}),$(".item-delete .delete-button").click(function(e){e.preventDefault();var t=$(this).siblings(".item-id-input").val(),i=$(this).siblings(".item-type-input").val(),n=$(this).parents(".item-container").find(".item-delete-content"),a=$(this).parents(".item-container").find(".item-delete .item-confirmation-content"),o=$(this).parents(".item-col"),l=$(this).parents(".range-container"),d=$(this).parents(".serie-container");$.ajax({url:"/collection/delete",data:"item_id="+t+"&item_type="+i,dataType:"json",success:function(e){e===!1?window.location.href="/members/login":(n.addClass("hidden"),a.removeClass("hidden"),updateMinifiguresCount(e),o.delay(1500).fadeOut(1e3,function(){l.find(".item-col").length<=1?l.remove():d.find(".item-col").length<=1?d.remove():o.remove()}))}})}),$(window).resize(function(){displayChart()})});